# Frontend API Compatibility Requirements

## 概要

既存のフロントエンドアプリケーションが期待するAPIエンドポイントとの互換性を確保するため、不足しているAPIエンドポイントを追加実装します。現在のフロントエンドは特定のエンドポイント構造（`/api/v1/studybooks/`）と機能（システム問題取得）を期待していますが、バックエンドにはこれらが実装されていません。

## 要件

### 要件1: StudyBooks言語エンドポイントの互換性

**ユーザーストーリー:** フロントエンド開発者として、既存のJavaScriptコードを変更せずに利用可能な言語リストを取得したい。現在のAPIコールが正常に動作するように。

#### 受入基準

1. フロントエンドが`/api/v1/studybooks/languages`にGETリクエストを送信する時、利用可能な言語のリストを返すこと
2. レスポンスが返される時、文字列の配列形式であること
3. エンドポイントがアクセスされる時、認証されたユーザーのコンテキストで動作すること
4. 言語リストが取得される時、デフォルトの言語セット（HTML、CSS、JavaScript、PHP、Java、Python3、SQL、Linux等）を含むこと

### 要件2: システム問題取得エンドポイントの実装

**ユーザーストーリー:** タイピング練習ユーザーとして、特定の言語のシステム問題を取得したい。選択した言語に関連する練習問題でタイピング練習ができるように。

#### 受入基準

1. フロントエンドが`/api/v1/studybooks/system-problems/{language}`にGETリクエストを送信する時、指定された言語の問題リストを返すこと
2. 問題データが返される時、問題文、回答、メタデータ（難易度、カテゴリ等）を含むこと
3. 言語パラメータが指定される時、大文字小文字を区別せずに処理すること
4. 問題が存在しない言語が指定される時、空の配列を返すこと
5. レスポンスが返される時、タイピング練習に適した形式（問題文と回答のペア）であること

### 要件3: エラーハンドリングと互換性

**ユーザーストーリー:** フロントエンド開発者として、既存のエラーハンドリングコードが正常に動作する一貫したエラーレスポンスが欲しい。予期しないエラーでアプリケーションが破綻しないように。

#### 受入基準

1. エンドポイントでエラーが発生する時、適切なHTTPステータスコードを返すこと
2. エラーレスポンスが返される時、フロントエンドが期待する形式（error、message、trace_id等）であること
3. 認証エラーが発生する時、401ステータスコードと適切なエラーメッセージを返すこと
4. 存在しない言語が指定される時、404ではなく空の結果を返すこと（フロントエンドの期待に合わせて）

### 要件4: パフォーマンスとキャッシュ

**ユーザーストーリー:** エンドユーザーとして、言語リストとシステム問題の取得が高速であることを期待する。タイピング練習の開始が遅延しないように。

#### 受入基準

1. 言語リストが要求される時、レスポンス時間が100ms以下であること
2. システム問題が要求される時、レスポンス時間が500ms以下であること
3. 同一言語の問題が繰り返し要求される時、効率的にデータを提供すること
4. データベースクエリが実行される時、適切なインデックスを使用して最適化されていること

### 要件5: データ整合性とテスト

**ユーザーストーリー:** 開発者として、新しいエンドポイントが既存のシステムと整合性を保ち、十分にテストされていることを確認したい。システムの信頼性を維持するために。

#### 受入基準

1. 新しいエンドポイントが追加される時、既存のAPIエンドポイントに影響を与えないこと
2. システム問題データが提供される時、既存の問題管理システムと一貫性を保つこと
3. エンドポイントが実装される時、ユニットテストと統合テストでカバーされること
4. API仕様が更新される時、OpenAPIドキュメントに反映されること

### 要件6: 既存デザイン・UI保持とコード品質

**ユーザーストーリー:** 開発者として、既存のデザインやUIを変更せずに機能を追加し、コードベースの品質を維持したい。システムの一貫性と保守性を確保するために。

#### 受入基準

1. 機能が追加される時、既存のフロントエンドデザインやUIに一切変更を加えないこと
2. 各タスクが完了する時、必ずコードのリファクタリングを実行し、可読性とシンプルさを確保すること
3. ファイルが作成される時、必要最低限の数に留め、機能の可用性を損なわないこと
4. 実装が行われる時、過度な抽象化を避け、実用的でシンプルなコードを優先すること
5. 新しいコードが追加される時、既存のコーディングスタイルと命名規則に従うこと
6. 重複コードが発見される時、DRY原則に従って統合・削除すること