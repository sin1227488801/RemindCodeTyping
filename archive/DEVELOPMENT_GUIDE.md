# RCT é–‹ç™ºã‚¬ã‚¤ãƒ‰ - åˆå­¦è€…å‘ã‘è©³ç´°è§£èª¬

## ğŸ¯ ã“ã®ã‚¬ã‚¤ãƒ‰ã®ç›®çš„

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°åˆå­¦è€…ãŒRemindCodeTypingï¼ˆRCTï¼‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç†è§£ã—ã€
ä¿å®ˆãƒ»é‹ç”¨ãƒ»æ”¹ä¿®ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“š å‰æçŸ¥è­˜

### å¿…è¦ãªåŸºç¤çŸ¥è­˜
- **Java**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®åŸºæœ¬
- **JavaScript**: ES6+ ã®åŸºæœ¬æ–‡æ³•
- **HTML/CSS**: Web ãƒšãƒ¼ã‚¸ã®åŸºæœ¬æ§‹é€ 
- **SQL**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åŸºæœ¬æ“ä½œ
- **Git**: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®åŸºæœ¬

### æ¨å¥¨å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹
- [Java ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://docs.oracle.com/javase/tutorial/)
- [MDN JavaScript ã‚¬ã‚¤ãƒ‰](https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide)
- [Spring Boot å…¬å¼ã‚¬ã‚¤ãƒ‰](https://spring.io/guides)

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç†è§£

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯ï¼Ÿ

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’å±¤ã«åˆ†ã‘ã¦è¨­è¨ˆã™ã‚‹æ‰‹æ³•ã§ã™ã€‚
å„å±¤ã«ã¯æ˜ç¢ºãªè²¬ä»»ãŒã‚ã‚Šã€ä¾å­˜é–¢ä¿‚ã®æ–¹å‘ãŒæ±ºã¾ã£ã¦ã„ã¾ã™ã€‚

```
å¤–å´ â†’ å†…å´ã¸ã®ä¾å­˜ã®ã¿è¨±å¯

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤              â”‚ â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®æ¥ç‚¹
â”‚     (UI, API)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤               â”‚ â† ãƒ“ã‚¸ãƒã‚¹ãƒ•ãƒ­ãƒ¼ã®åˆ¶å¾¡
â”‚     (ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹, ã‚µãƒ¼ãƒ“ã‚¹)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤                      â”‚ â† ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®ä¸­æ ¸
â”‚     (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£, å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤           â”‚ â† æŠ€è¡“çš„ãªå®Ÿè£…è©³ç´°
â”‚     (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹, å¤–éƒ¨API)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœã“ã®æ§‹é€ ã«ã™ã‚‹ã®ã‹ï¼Ÿ

1. **å¤‰æ›´ã®å½±éŸ¿ã‚’é™å®š**: ä¸€ã¤ã®å±¤ã®å¤‰æ›´ãŒä»–ã®å±¤ã«å½±éŸ¿ã—ã«ãã„
2. **ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„**: å„å±¤ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆã§ãã‚‹
3. **ç†è§£ã—ã‚„ã™ã„**: è²¬ä»»ãŒæ˜ç¢ºã§ã€ã©ã“ã«ä½•ãŒã‚ã‚‹ã‹ã‚ã‹ã‚Šã‚„ã™ã„
4. **å†åˆ©ç”¨ã—ã‚„ã™ã„**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚ä½¿ãˆã‚‹

## ğŸ” å„å±¤ã®è©³ç´°è§£èª¬

### 1. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆDomain Layerï¼‰

**å½¹å‰²**: ãƒ“ã‚¸ãƒã‚¹ã®æ ¸ã¨ãªã‚‹ãƒ«ãƒ¼ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†

#### ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆEntityï¼‰ã®ä¾‹
```java
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
 * ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä¸€æ„ã®IDã‚’æŒã¡ã€ãƒ­ã‚°ã‚¤ãƒ³çµ±è¨ˆã‚’ç®¡ç†ã™ã‚‹
 */
public class User {
    private final UserId id;           // ä¸€æ„è­˜åˆ¥å­ï¼ˆå¤‰æ›´ä¸å¯ï¼‰
    private final LoginId loginId;     // ãƒ­ã‚°ã‚¤ãƒ³IDï¼ˆå¤‰æ›´ä¸å¯ï¼‰
    private LoginStatistics statistics; // ãƒ­ã‚°ã‚¤ãƒ³çµ±è¨ˆï¼ˆå¤‰æ›´å¯èƒ½ï¼‰
    
    /**
     * ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨˜éŒ²ã™ã‚‹ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
     * - é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³æ—¥æ•°ã‚’æ›´æ–°
     * - æœ€å¤§é€£ç¶šæ—¥æ•°ã‚’è¨˜éŒ²
     * - ç·ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ•°ã‚’å¢—åŠ 
     */
    public void recordLogin(LocalDate loginDate) {
        // ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’ã“ã“ã«å®Ÿè£…
        this.statistics = this.statistics.updateForLogin(loginDate);
    }
}
```

#### å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆValue Objectï¼‰ã®ä¾‹
```java
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼IDå€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * ç‰¹å¾´: ä¸å¤‰ï¼ˆä¸€åº¦ä½œã£ãŸã‚‰å¤‰æ›´ã§ããªã„ï¼‰
 */
public class UserId {
    private final String value;
    
    private UserId(String value) {
        // æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯: nullã‚„ç©ºæ–‡å­—ã¯è¨±å¯ã—ãªã„
        if (value == null || value.trim().isEmpty()) {
            throw new IllegalArgumentException("ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¯ç©ºã«ã§ãã¾ã›ã‚“");
        }
        this.value = value;
    }
    
    // ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã®å”¯ä¸€ã®æ–¹æ³•
    public static UserId of(String value) {
        return new UserId(value);
    }
}
```

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆApplication Layerï¼‰

**å½¹å‰²**: ãƒ“ã‚¸ãƒã‚¹ãƒ•ãƒ­ãƒ¼ã®èª¿æ•´ã¨å¤–éƒ¨ã‹ã‚‰ã®è¦æ±‚å‡¦ç†

#### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆUse Caseï¼‰ã®ä¾‹
```java
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
 * ç›®çš„: ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ã®ä¸€é€£ã®æµã‚Œã‚’ç®¡ç†
 */
@Service
public class AuthenticateUserUseCase {
    private final UserRepository userRepository;
    private final PasswordService passwordService;
    private final JwtTokenService tokenService;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚’å®Ÿè¡Œ
     * 
     * å‡¦ç†ãƒ•ãƒ­ãƒ¼:
     * 1. ãƒ­ã‚°ã‚¤ãƒ³IDã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
     * 2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œè¨¼
     * 3. ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨˜éŒ²
     * 4. JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆ
     * 5. çµæœã‚’è¿”å´
     */
    public AuthenticationResult authenticate(LoginId loginId, String password) {
        // 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
        User user = userRepository.findByLoginId(loginId)
            .orElseThrow(() -> new AuthenticationException("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"));
        
        // 2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼
        if (!passwordService.matches(password, user.getPasswordHash())) {
            throw new AuthenticationException("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");
        }
        
        // 3. ãƒ­ã‚°ã‚¤ãƒ³è¨˜éŒ²ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯å‘¼ã³å‡ºã—ï¼‰
        user.recordLogin(LocalDate.now());
        userRepository.save(user);
        
        // 4. ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ
        String token = tokenService.generateToken(user);
        
        // 5. çµæœè¿”å´
        return AuthenticationResult.success(user, token);
    }
}
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆApplication Serviceï¼‰ã®ä¾‹
```java
/**
 * èªè¨¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹
 * ç›®çš„: è¤‡æ•°ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’çµ„ã¿åˆã‚ã›ãŸé«˜ãƒ¬ãƒ™ãƒ«å‡¦ç†
 */
@Service
public class AuthenticationApplicationService {
    private final AuthenticateUserUseCase authenticateUseCase;
    private final RegisterUserUseCase registerUseCase;
    
    /**
     * ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
     * ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®è¦æ±‚ã‚’å—ã‘ã¦ã€é©åˆ‡ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å‘¼ã³å‡ºã™
     */
    public AuthenticationResult login(String loginId, String password) {
        try {
            return authenticateUseCase.authenticate(
                LoginId.of(loginId), 
                password
            );
        } catch (Exception e) {
            // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›
            log.error("ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {}", e.getMessage());
            throw e;
        }
    }
}
```

### 3. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ï¼ˆInfrastructure Layerï¼‰

**å½¹å‰²**: æŠ€è¡“çš„ãªå®Ÿè£…è©³ç´°ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€å¤–éƒ¨APIç­‰ï¼‰

#### ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ã®ä¾‹
```java
/**
 * JPA ã‚’ä½¿ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªãƒã‚¸ãƒˆãƒªã®å®Ÿè£…
 * ç›®çš„: ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®UserRepositoryã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…
 */
@Repository
public class JpaUserRepositoryImpl implements UserRepository {
    private final JpaUserEntityRepository jpaRepository;
    private final UserMapper mapper;
    
    /**
     * ãƒ­ã‚°ã‚¤ãƒ³IDã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
     * 
     * å‡¦ç†ã®æµã‚Œ:
     * 1. JPA ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æ¤œç´¢
     * 2. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
     * 3. Optional ã§çµæœã‚’è¿”å´
     */
    @Override
    public Optional<User> findByLoginId(LoginId loginId) {
        return jpaRepository.findByLoginId(loginId.getValue())
            .map(mapper::toDomain);  // ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›
    }
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¿å­˜
     * 
     * å‡¦ç†ã®æµã‚Œ:
     * 1. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¤‰æ›
     * 2. JPA ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
     * 3. ä¿å­˜çµæœã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã—ã¦è¿”å´
     */
    @Override
    public User save(User user) {
        UserEntity entity = mapper.toEntity(user);  // ãƒ‰ãƒ¡ã‚¤ãƒ³ â†’ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å¤‰æ›
        UserEntity saved = jpaRepository.save(entity);
        return mapper.toDomain(saved);  // ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³å¤‰æ›
    }
}
```

#### ãƒãƒƒãƒ‘ãƒ¼ï¼ˆMapperï¼‰ã®ä¾‹
```java
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒƒãƒ‘ãƒ¼
 * ç›®çš„: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨JPAã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ç›¸äº’å¤‰æ›
 */
@Component
public class UserMapper {
    
    /**
     * JPAã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‹ã‚‰ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
     * 
     * æ³¨æ„ç‚¹:
     * - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é©åˆ‡ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
     * - null ãƒã‚§ãƒƒã‚¯ã‚’å¿˜ã‚Œãšã«è¡Œã†
     * - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ãŸå¤‰æ›ã‚’è¡Œã†
     */
    public User toDomain(UserEntity entity) {
        if (entity == null) {
            return null;
        }
        
        return User.reconstruct(
            UserId.of(entity.getId()),
            LoginId.of(entity.getLoginId()),
            PasswordHash.of(entity.getPasswordHash()),
            Role.valueOf(entity.getRole()),
            LoginStatistics.of(
                entity.getLastLoginDate(),
                entity.getConsecutiveDays(),
                entity.getMaxConsecutiveDays(),
                entity.getTotalDays()
            ),
            entity.getCreatedAt(),
            entity.getUpdatedAt()
        );
    }
    
    /**
     * ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰JPAã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«å¤‰æ›
     */
    public UserEntity toEntity(User user) {
        if (user == null) {
            return null;
        }
        
        UserEntity entity = new UserEntity();
        entity.setId(user.getId().getValue());
        entity.setLoginId(user.getLoginId().getValue());
        entity.setPasswordHash(user.getPasswordHash().getValue());
        entity.setRole(user.getRole().name());
        
        LoginStatistics stats = user.getLoginStatistics();
        entity.setLastLoginDate(stats.getLastLoginDate());
        entity.setConsecutiveDays(stats.getConsecutiveDays());
        entity.setMaxConsecutiveDays(stats.getMaxConsecutiveDays());
        entity.setTotalDays(stats.getTotalDays());
        
        entity.setCreatedAt(user.getCreatedAt());
        entity.setUpdatedAt(user.getUpdatedAt());
        
        return entity;
    }
}
```

### 4. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆPresentation Layerï¼‰

**å½¹å‰²**: å¤–éƒ¨ã¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆREST APIã€Web UIï¼‰

#### REST ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ä¾‹
```java
/**
 * èªè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
 * ç›®çš„: èªè¨¼é–¢é€£ã®HTTPã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’æä¾›
 */
@RestController
@RequestMapping("/api/auth")
@Validated
public class AuthController {
    private final AuthenticationApplicationService authService;
    private final AuthenticationDtoMapper mapper;
    
    /**
     * ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
     * 
     * å‡¦ç†ã®æµã‚Œ:
     * 1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¤œè¨¼
     * 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®å‘¼ã³å‡ºã—
     * 3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç”Ÿæˆ
     * 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
     */
    @PostMapping("/login")
    public ResponseEntity<AuthenticationResponse> login(
            @Valid @RequestBody LoginRequest request) {
        
        try {
            // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒ“ã‚¹å‘¼ã³å‡ºã—
            AuthenticationResult result = authService.login(
                request.getLoginId(),
                request.getPassword()
            );
            
            // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆ
            AuthenticationResponse response = mapper.toResponse(result);
            
            return ResponseEntity.ok(response);
            
        } catch (AuthenticationException e) {
            // èªè¨¼ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯401ã‚’è¿”å´
            throw new ResponseStatusException(
                HttpStatus.UNAUTHORIZED, 
                e.getMessage()
            );
        }
    }
}
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ä¾‹
```javascript
/**
 * èªè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
 * ç›®çš„: èªè¨¼é–¢é€£ã®UIæ“ä½œã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’èª¿æ•´
 */
class AuthController {
    constructor(authService, userRepository, errorHandler) {
        this.authService = authService;      // èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹
        this.userRepository = userRepository; // ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ç®¡ç†
        this.errorHandler = errorHandler;     // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
    }
    
    /**
     * ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
     * 
     * å‡¦ç†ã®æµã‚Œ:
     * 1. ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¨æ¤œè¨¼
     * 2. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®è¡¨ç¤º
     * 3. èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã®å‘¼ã³å‡ºã—
     * 4. æˆåŠŸæ™‚ã®å‡¦ç†ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¿å­˜ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰
     * 5. ã‚¨ãƒ©ãƒ¼æ™‚ã®å‡¦ç†ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºï¼‰
     */
    async handleLogin(event) {
        event.preventDefault();
        
        try {
            // 1. ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—
            const formData = new FormData(event.target);
            const credentials = {
                loginId: formData.get('loginId')?.trim(),
                password: formData.get('password')
            };
            
            // 2. å…¥åŠ›æ¤œè¨¼
            const validationResult = this.validateLoginCredentials(credentials);
            if (!validationResult.isValid) {
                this.displayValidationErrors(validationResult.errors);
                return;
            }
            
            // 3. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹è¡¨ç¤º
            this.setLoadingState(true);
            
            // 4. èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹å‘¼ã³å‡ºã—
            const result = await this.authService.login(
                credentials.loginId, 
                credentials.password
            );
            
            if (result.success) {
                // 5. æˆåŠŸæ™‚å‡¦ç†
                this.userRepository.setCurrentUser(result.user);
                this.onLoginSuccess(result.user);
            } else {
                // 6. å¤±æ•—æ™‚å‡¦ç†
                this.displayError(result.error || 'ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
            
        } catch (error) {
            // 7. ä¾‹å¤–å‡¦ç†
            this.errorHandler.handle(error, { context: 'login' });
        } finally {
            // 8. å¾Œå‡¦ç†ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹è§£é™¤ï¼‰
            this.setLoadingState(false);
        }
    }
    
    /**
     * å…¥åŠ›æ¤œè¨¼
     * ç›®çš„: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
     */
    validateLoginCredentials(credentials) {
        const errors = [];
        
        // ãƒ­ã‚°ã‚¤ãƒ³IDæ¤œè¨¼
        if (!credentials.loginId) {
            errors.push(ValidationError.required('loginId'));
        } else if (credentials.loginId.length < 3) {
            errors.push(ValidationError.invalidLength('loginId', 3, null, credentials.loginId));
        }
        
        // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼
        if (!credentials.password) {
            errors.push(ValidationError.required('password'));
        } else if (credentials.password.length < 6) {
            errors.push(ValidationError.invalidLength('password', 6, null, credentials.password));
        }
        
        return errors.length > 0 
            ? ValidationResult.failure(errors) 
            : ValidationResult.success();
    }
}
```

## ğŸ”§ é–‹ç™ºä½œæ¥­ã®é€²ã‚æ–¹

### æ–°æ©Ÿèƒ½è¿½åŠ ã®æ‰‹é †

#### 1. è¦ä»¶ã®ç†è§£
```
ä¾‹: ã€Œå­¦ç¿’å¸³ã«ã‚¿ã‚°æ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã„ã€

è³ªå•ã™ã¹ãã“ã¨:
- ã‚¿ã‚°ã¯ã©ã®ã‚ˆã†ãªæƒ…å ±ã‚’æŒã¤ã‹ï¼Ÿï¼ˆåå‰ã€è‰²ã€èª¬æ˜ãªã©ï¼‰
- ä¸€ã¤ã®å­¦ç¿’å¸³ã«è¤‡æ•°ã®ã‚¿ã‚°ã‚’ä»˜ã‘ã‚‰ã‚Œã‚‹ã‹ï¼Ÿ
- ã‚¿ã‚°ã§å­¦ç¿’å¸³ã‚’æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã‹ï¼Ÿ
- èª°ãŒã‚¿ã‚°ã‚’ä½œæˆãƒ»ç®¡ç†ã™ã‚‹ã‹ï¼Ÿ
```

#### 2. ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®è¨­è¨ˆ
```java
/**
 * ã‚¿ã‚°å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 * ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«: ã‚¿ã‚°ã¯åå‰ã¨è‰²ã‚’æŒã¤ä¸å¤‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
 */
public class Tag {
    private final String name;    // ã‚¿ã‚°åï¼ˆå¿…é ˆã€1-20æ–‡å­—ï¼‰
    private final String color;   // è‰²ã‚³ãƒ¼ãƒ‰ï¼ˆå¿…é ˆã€#RRGGBBå½¢å¼ï¼‰
    
    private Tag(String name, String color) {
        validateName(name);
        validateColor(color);
        this.name = name;
        this.color = color;
    }
    
    public static Tag of(String name, String color) {
        return new Tag(name, color);
    }
    
    private void validateName(String name) {
        if (name == null || name.trim().isEmpty()) {
            throw new IllegalArgumentException("ã‚¿ã‚°åã¯å¿…é ˆã§ã™");
        }
        if (name.length() > 20) {
            throw new IllegalArgumentException("ã‚¿ã‚°åã¯20æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
        }
    }
    
    private void validateColor(String color) {
        if (color == null || !color.matches("^#[0-9A-Fa-f]{6}$")) {
            throw new IllegalArgumentException("è‰²ã¯#RRGGBBå½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
        }
    }
}
```

#### 3. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®æ›´æ–°
```java
/**
 * StudyBook ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ã‚¿ã‚°æ©Ÿèƒ½ã‚’è¿½åŠ 
 */
public final class StudyBook {
    // æ—¢å­˜ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    private final StudyBookId id;
    private final UserId userId;
    private final Language language;
    private final Question question;
    private final Explanation explanation;
    
    // æ–°è¦è¿½åŠ : ã‚¿ã‚°ã®ã‚»ãƒƒãƒˆ
    private final Set<Tag> tags;
    
    /**
     * ã‚¿ã‚°ã‚’è¿½åŠ ã™ã‚‹
     * ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«: ä¸€ã¤ã®å­¦ç¿’å¸³ã«æœ€å¤§5å€‹ã¾ã§ã‚¿ã‚°ã‚’ä»˜ã‘ã‚‰ã‚Œã‚‹
     */
    public StudyBook addTag(Tag tag) {
        if (tags.size() >= 5) {
            throw new IllegalStateException("ã‚¿ã‚°ã¯æœ€å¤§5å€‹ã¾ã§è¿½åŠ ã§ãã¾ã™");
        }
        
        Set<Tag> newTags = new HashSet<>(this.tags);
        newTags.add(tag);
        
        return new StudyBook(
            id, userId, language, question, explanation, 
            newTags,  // æ–°ã—ã„ã‚¿ã‚°ã‚»ãƒƒãƒˆ
            isSystemProblem, createdAt, LocalDateTime.now()
        );
    }
    
    /**
     * æŒ‡å®šã•ã‚ŒãŸã‚¿ã‚°ã‚’æŒã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
     */
    public boolean hasTag(Tag tag) {
        return tags.contains(tag);
    }
}
```

#### 4. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®å®Ÿè£…
```java
/**
 * å­¦ç¿’å¸³ã«ã‚¿ã‚°ã‚’è¿½åŠ ã™ã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
 */
@Service
public class AddTagToStudyBookUseCase {
    private final StudyBookRepository studyBookRepository;
    
    /**
     * å­¦ç¿’å¸³ã«ã‚¿ã‚°ã‚’è¿½åŠ 
     * 
     * å‡¦ç†ãƒ•ãƒ­ãƒ¼:
     * 1. å­¦ç¿’å¸³ã®å­˜åœ¨ç¢ºèª
     * 2. æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆè‡ªåˆ†ã®å­¦ç¿’å¸³ã‹ã©ã†ã‹ï¼‰
     * 3. ã‚¿ã‚°è¿½åŠ ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯å‘¼ã³å‡ºã—ï¼‰
     * 4. ä¿å­˜
     */
    public StudyBook addTag(StudyBookId studyBookId, UserId userId, Tag tag) {
        // 1. å­¦ç¿’å¸³å–å¾—
        StudyBook studyBook = studyBookRepository.findById(studyBookId)
            .orElseThrow(() -> new StudyBookNotFoundException("å­¦ç¿’å¸³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"));
        
        // 2. æ¨©é™ãƒã‚§ãƒƒã‚¯
        if (!studyBook.belongsToUser(userId)) {
            throw new UnauthorizedException("ã“ã®å­¦ç¿’å¸³ã‚’ç·¨é›†ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“");
        }
        
        // 3. ã‚¿ã‚°è¿½åŠ ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
        StudyBook updatedStudyBook = studyBook.addTag(tag);
        
        // 4. ä¿å­˜
        return studyBookRepository.save(updatedStudyBook);
    }
}
```

#### 5. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®è¿½åŠ 
```java
/**
 * å­¦ç¿’å¸³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã«ã‚¿ã‚°é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ 
 */
@RestController
@RequestMapping("/api/studybooks")
public class StudyBookController {
    
    /**
     * å­¦ç¿’å¸³ã«ã‚¿ã‚°ã‚’è¿½åŠ 
     * POST /api/studybooks/{id}/tags
     */
    @PostMapping("/{id}/tags")
    public ResponseEntity<StudyBookResponse> addTag(
            @PathVariable String id,
            @RequestBody AddTagRequest request,
            @RequestHeader("X-User-Id") String userId) {
        
        try {
            // ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¤œè¨¼
            if (request.getName() == null || request.getColor() == null) {
                return ResponseEntity.badRequest().build();
            }
            
            // ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å‘¼ã³å‡ºã—
            StudyBook result = addTagUseCase.addTag(
                StudyBookId.of(id),
                UserId.of(userId),
                Tag.of(request.getName(), request.getColor())
            );
            
            // ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆ
            StudyBookResponse response = mapper.toResponse(result);
            return ResponseEntity.ok(response);
            
        } catch (StudyBookNotFoundException e) {
            return ResponseEntity.notFound().build();
        } catch (UnauthorizedException e) {
            return ResponseEntity.status(HttpStatus.FORBIDDEN).build();
        } catch (IllegalArgumentException | IllegalStateException e) {
            return ResponseEntity.badRequest()
                .body(ErrorResponse.of(e.getMessage()));
        }
    }
}
```

#### 6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å®Ÿè£…
```javascript
/**
 * ã‚¿ã‚°è¿½åŠ æ©Ÿèƒ½ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…
 */
class StudyBookController {
    
    /**
     * ã‚¿ã‚°è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡å‡¦ç†
     */
    async handleAddTag(studyBookId, tagData) {
        try {
            // å…¥åŠ›æ¤œè¨¼
            const validationResult = this.validateTagData(tagData);
            if (!validationResult.isValid) {
                this.displayValidationErrors(validationResult.errors);
                return;
            }
            
            // API å‘¼ã³å‡ºã—
            const result = await this.studyBookApiService.addTag(studyBookId, tagData);
            
            if (result.success) {
                // æˆåŠŸæ™‚ã®å‡¦ç†
                this.displaySuccessMessage('ã‚¿ã‚°ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ');
                this.refreshStudyBookList();
            } else {
                this.displayError(result.error);
            }
            
        } catch (error) {
            this.errorHandler.handle(error, { context: 'add_tag' });
        }
    }
    
    /**
     * ã‚¿ã‚°ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
     */
    validateTagData(tagData) {
        const errors = [];
        
        // ã‚¿ã‚°åæ¤œè¨¼
        if (!tagData.name || tagData.name.trim().length === 0) {
            errors.push(ValidationError.required('name'));
        } else if (tagData.name.length > 20) {
            errors.push(ValidationError.invalidLength('name', 1, 20, tagData.name));
        }
        
        // è‰²æ¤œè¨¼
        if (!tagData.color || !/^#[0-9A-Fa-f]{6}$/.test(tagData.color)) {
            errors.push(ValidationError.invalidFormat('color', '#RRGGBBå½¢å¼', tagData.color));
        }
        
        return errors.length > 0 
            ? ValidationResult.failure(errors) 
            : ValidationResult.success();
    }
}
```

### ãƒã‚°ä¿®æ­£ã®æ‰‹é †

#### 1. å•é¡Œã®ç‰¹å®š
```
ä¾‹: ã€Œãƒ­ã‚°ã‚¤ãƒ³å¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒè¡¨ç¤ºã•ã‚Œãªã„ã€

èª¿æŸ»æ‰‹é †:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§APIé€šä¿¡ã‚’ç¢ºèª
3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ­ã‚°ã‚’ç¢ºèª
4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª
```

#### 2. åŸå› ã®åˆ†æ
```javascript
// å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹
class AuthController {
    async handleLogin(event) {
        const result = await this.authService.login(loginId, password);
        
        if (result.success) {
            // å•é¡Œ: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã—ã¦ã„ãªã„
            this.redirectToMainPage();  // â† ã“ã“ãŒå•é¡Œ
        }
    }
}
```

#### 3. ä¿®æ­£ã®å®Ÿè£…
```javascript
// ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰
class AuthController {
    async handleLogin(event) {
        const result = await this.authService.login(loginId, password);
        
        if (result.success) {
            // ä¿®æ­£: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã—ã¦ã‹ã‚‰ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            this.userRepository.setCurrentUser(result.user);  // â† è¿½åŠ 
            this.redirectToMainPage();
        }
    }
}
```

#### 4. ãƒ†ã‚¹ãƒˆã®è¿½åŠ 
```javascript
// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è¿½åŠ 
describe('AuthController', () => {
    test('ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸæ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒä¿å­˜ã•ã‚Œã‚‹ã“ã¨', async () => {
        // Arrange
        const mockAuthService = {
            login: jest.fn().mockResolvedValue({
                success: true,
                user: new User('123', 'testuser', false, 'token')
            })
        };
        const mockUserRepository = {
            setCurrentUser: jest.fn()
        };
        
        const controller = new AuthController(mockAuthService, mockUserRepository);
        
        // Act
        await controller.handleLogin(mockEvent);
        
        // Assert
        expect(mockUserRepository.setCurrentUser).toHaveBeenCalledWith(
            expect.objectContaining({ loginId: 'testuser' })
        );
    });
});
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®åŸºæœ¬

#### ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆ
```java
/**
 * User ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ†ã‚¹ãƒˆ
 * ç›®çš„: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
 */
class UserTest {
    
    @Test
    @DisplayName("ãƒ­ã‚°ã‚¤ãƒ³è¨˜éŒ²æ™‚ã«çµ±è¨ˆãŒæ­£ã—ãæ›´æ–°ã•ã‚Œã‚‹ã“ã¨")
    void recordLogin_ShouldUpdateStatistics() {
        // Arrangeï¼ˆæº–å‚™ï¼‰
        User user = User.create(
            UserId.of("user123"),
            LoginId.of("testuser"),
            PasswordHash.of("hashedPassword")
        );
        LocalDate loginDate = LocalDate.of(2024, 1, 15);
        
        // Actï¼ˆå®Ÿè¡Œï¼‰
        user.recordLogin(loginDate);
        
        // Assertï¼ˆæ¤œè¨¼ï¼‰
        assertThat(user.getTotalLoginDays()).isEqualTo(1);
        assertThat(user.getCurrentLoginStreak()).isEqualTo(1);
        assertThat(user.getLoginStatistics().getLastLoginDate()).isEqualTo(loginDate);
    }
    
    @Test
    @DisplayName("é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã‚¹ãƒˆãƒªãƒ¼ã‚¯ãŒå¢—åŠ ã™ã‚‹ã“ã¨")
    void recordLogin_ConsecutiveDays_ShouldIncreaseStreak() {
        // Arrange
        User user = User.create(
            UserId.of("user123"),
            LoginId.of("testuser"),
            PasswordHash.of("hashedPassword")
        );
        
        // Act: 3æ—¥é€£ç¶šã§ãƒ­ã‚°ã‚¤ãƒ³
        user.recordLogin(LocalDate.of(2024, 1, 13));
        user.recordLogin(LocalDate.of(2024, 1, 14));
        user.recordLogin(LocalDate.of(2024, 1, 15));
        
        // Assert
        assertThat(user.getCurrentLoginStreak()).isEqualTo(3);
        assertThat(user.getTotalLoginDays()).isEqualTo(3);
    }
    
    @Test
    @DisplayName("ãƒ­ã‚°ã‚¤ãƒ³æ—¥ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸå ´åˆã«ã‚¹ãƒˆãƒªãƒ¼ã‚¯ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã“ã¨")
    void recordLogin_SkipDay_ShouldResetStreak() {
        // Arrange
        User user = User.create(
            UserId.of("user123"),
            LoginId.of("testuser"),
            PasswordHash.of("hashedPassword")
        );
        
        // Act: 1æ—¥ç›®ã€3æ—¥ç›®ã«ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆ2æ—¥ç›®ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰
        user.recordLogin(LocalDate.of(2024, 1, 13));
        user.recordLogin(LocalDate.of(2024, 1, 15));  // 1æ—¥ã‚¹ã‚­ãƒƒãƒ—
        
        // Assert
        assertThat(user.getCurrentLoginStreak()).isEqualTo(1);  // ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦1
        assertThat(user.getTotalLoginDays()).isEqualTo(2);      // ç·æ—¥æ•°ã¯2
    }
}
```

#### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
```java
/**
 * èªè¨¼ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ
 * ç›®çš„: ãƒ“ã‚¸ãƒã‚¹ãƒ•ãƒ­ãƒ¼ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
 */
class AuthenticateUserUseCaseTest {
    
    @Mock
    private UserRepository userRepository;
    
    @Mock
    private PasswordService passwordService;
    
    @Mock
    private JwtTokenService tokenService;
    
    @InjectMocks
    private AuthenticateUserUseCase useCase;
    
    @Test
    @DisplayName("æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã™ã‚‹ã“ã¨")
    void authenticate_ValidCredentials_ShouldSucceed() {
        // Arrange
        LoginId loginId = LoginId.of("testuser");
        String password = "password123";
        User user = createTestUser();
        String expectedToken = "jwt.token.here";
        
        when(userRepository.findByLoginId(loginId)).thenReturn(Optional.of(user));
        when(passwordService.matches(password, user.getPasswordHash())).thenReturn(true);
        when(tokenService.generateToken(user)).thenReturn(expectedToken);
        
        // Act
        AuthenticationResult result = useCase.authenticate(loginId, password);
        
        // Assert
        assertThat(result.isSuccess()).isTrue();
        assertThat(result.getUser()).isEqualTo(user);
        assertThat(result.getToken()).isEqualTo(expectedToken);
        
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
        verify(userRepository).save(user);
    }
    
    @Test
    @DisplayName("å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³ãŒå¤±æ•—ã™ã‚‹ã“ã¨")
    void authenticate_UserNotFound_ShouldThrowException() {
        // Arrange
        LoginId loginId = LoginId.of("nonexistent");
        String password = "password123";
        
        when(userRepository.findByLoginId(loginId)).thenReturn(Optional.empty());
        
        // Act & Assert
        assertThatThrownBy(() -> useCase.authenticate(loginId, password))
            .isInstanceOf(AuthenticationException.class)
            .hasMessage("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
    }
    
    @Test
    @DisplayName("é–“é•ã£ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³ãŒå¤±æ•—ã™ã‚‹ã“ã¨")
    void authenticate_WrongPassword_ShouldThrowException() {
        // Arrange
        LoginId loginId = LoginId.of("testuser");
        String wrongPassword = "wrongpassword";
        User user = createTestUser();
        
        when(userRepository.findByLoginId(loginId)).thenReturn(Optional.of(user));
        when(passwordService.matches(wrongPassword, user.getPasswordHash())).thenReturn(false);
        
        // Act & Assert
        assertThatThrownBy(() -> useCase.authenticate(loginId, wrongPassword))
            .isInstanceOf(AuthenticationException.class)
            .hasMessage("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");
    }
    
    private User createTestUser() {
        return User.create(
            UserId.of("user123"),
            LoginId.of("testuser"),
            PasswordHash.of("hashedPassword")
        );
    }
}
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ†ã‚¹ãƒˆ
```javascript
/**
 * AuthController ã®ãƒ†ã‚¹ãƒˆ
 * ç›®çš„: UIåˆ¶å¾¡ãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
 */
describe('AuthController', () => {
    let authController;
    let mockAuthService;
    let mockUserRepository;
    let mockErrorHandler;
    
    beforeEach(() => {
        // ãƒ¢ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æº–å‚™
        mockAuthService = {
            login: jest.fn()
        };
        mockUserRepository = {
            setCurrentUser: jest.fn()
        };
        mockErrorHandler = {
            handle: jest.fn()
        };
        
        authController = new AuthController(
            mockAuthService,
            mockUserRepository,
            mockErrorHandler
        );
    });
    
    test('æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã™ã‚‹ã“ã¨', async () => {
        // Arrange
        const mockUser = new User('123', 'testuser', false, 'token');
        mockAuthService.login.mockResolvedValue({
            success: true,
            user: mockUser
        });
        
        const mockEvent = {
            preventDefault: jest.fn(),
            target: createMockForm({
                loginId: 'testuser',
                password: 'password123'
            })
        };
        
        // Act
        await authController.handleLogin(mockEvent);
        
        // Assert
        expect(mockAuthService.login).toHaveBeenCalledWith('testuser', 'password123');
        expect(mockUserRepository.setCurrentUser).toHaveBeenCalledWith(mockUser);
    });
    
    test('å…¥åŠ›æ¤œè¨¼ã‚¨ãƒ©ãƒ¼æ™‚ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', async () => {
        // Arrange
        const mockEvent = {
            preventDefault: jest.fn(),
            target: createMockForm({
                loginId: '',  // ç©ºã®ãƒ­ã‚°ã‚¤ãƒ³ID
                password: 'password123'
            })
        };
        
        // displayValidationErrors ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚¹ãƒ‘ã‚¤
        const displayErrorsSpy = jest.spyOn(authController, 'displayValidationErrors');
        
        // Act
        await authController.handleLogin(mockEvent);
        
        // Assert
        expect(displayErrorsSpy).toHaveBeenCalledWith(
            expect.arrayContaining([
                expect.objectContaining({
                    field: 'loginId',
                    code: 'REQUIRED'
                })
            ])
        );
        
        // API ã¯å‘¼ã³å‡ºã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª
        expect(mockAuthService.login).not.toHaveBeenCalled();
    });
    
    function createMockForm(data) {
        return {
            elements: Object.entries(data).map(([name, value]) => ({
                name,
                value
            }))
        };
    }
});
```

### çµ±åˆãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹

#### API çµ±åˆãƒ†ã‚¹ãƒˆ
```java
/**
 * èªè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®çµ±åˆãƒ†ã‚¹ãƒˆ
 * ç›®çš„: HTTP ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
 */
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)
@TestPropertySource(properties = {
    "spring.datasource.url=jdbc:h2:mem:testdb",
    "spring.jpa.hibernate.ddl-auto=create-drop"
})
class AuthControllerIntegrationTest {
    
    @Autowired
    private TestRestTemplate restTemplate;
    
    @Autowired
    private UserRepository userRepository;
    
    @Autowired
    private PasswordService passwordService;
    
    @Test
    @DisplayName("POST /api/auth/login - æ­£å¸¸ãªãƒ­ã‚°ã‚¤ãƒ³")
    void login_ValidCredentials_ShouldReturnToken() {
        // Arrange: ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
        User testUser = User.create(
            UserId.generate(),
            LoginId.of("testuser"),
            passwordService.hash("password123")
        );
        userRepository.save(testUser);
        
        LoginRequest request = new LoginRequest("testuser", "password123");
        
        // Act: API å‘¼ã³å‡ºã—
        ResponseEntity<AuthenticationResponse> response = restTemplate.postForEntity(
            "/api/auth/login",
            request,
            AuthenticationResponse.class
        );
        
        // Assert
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK);
        assertThat(response.getBody()).isNotNull();
        assertThat(response.getBody().getUser().getLoginId()).isEqualTo("testuser");
        assertThat(response.getBody().getToken()).isNotBlank();
    }
    
    @Test
    @DisplayName("POST /api/auth/login - å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼")
    void login_UserNotFound_ShouldReturn401() {
        // Arrange
        LoginRequest request = new LoginRequest("nonexistent", "password123");
        
        // Act
        ResponseEntity<ErrorResponse> response = restTemplate.postForEntity(
            "/api/auth/login",
            request,
            ErrorResponse.class
        );
        
        // Assert
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.UNAUTHORIZED);
        assertThat(response.getBody().getMessage()).contains("ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
    }
    
    @Test
    @DisplayName("POST /api/auth/login - ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼")
    void login_InvalidRequest_ShouldReturn400() {
        // Arrange: ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆãƒ­ã‚°ã‚¤ãƒ³IDãŒç©ºï¼‰
        LoginRequest request = new LoginRequest("", "password123");
        
        // Act
        ResponseEntity<ErrorResponse> response = restTemplate.postForEntity(
            "/api/auth/login",
            request,
            ErrorResponse.class
        );
        
        // Assert
        assertThat(response.getStatusCode()).isEqualTo(HttpStatus.BAD_REQUEST);
    }
}
```

## ğŸš¨ ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

### 1. NullPointerException
```java
// å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
public User findUser(String loginId) {
    UserEntity entity = repository.findByLoginId(loginId);
    return mapper.toDomain(entity);  // entity ãŒ null ã®å ´åˆã« NPE
}

// ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰
public Optional<User> findUser(String loginId) {
    UserEntity entity = repository.findByLoginId(loginId);
    return entity != null ? Optional.of(mapper.toDomain(entity)) : Optional.empty();
}

// ã•ã‚‰ã«è‰¯ã„ä¿®æ­£ï¼ˆOptional ã‚’æ´»ç”¨ï¼‰
public Optional<User> findUser(String loginId) {
    return repository.findByLoginId(loginId)
        .map(mapper::toDomain);
}
```

### 2. å¾ªç’°ä¾å­˜
```java
// å•é¡Œ: AãŒBã«ä¾å­˜ã—ã€BãŒAã«ä¾å­˜ã—ã¦ã„ã‚‹
@Service
public class UserService {
    @Autowired
    private StudyBookService studyBookService;  // B ã«ä¾å­˜
}

@Service
public class StudyBookService {
    @Autowired
    private UserService userService;  // A ã«ä¾å­˜ â† å¾ªç’°ä¾å­˜
}

// è§£æ±ºæ–¹æ³•1: å…±é€šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ
@Service
public class UserStudyBookService {
    private final UserRepository userRepository;
    private final StudyBookRepository studyBookRepository;
    
    // ä¸¡æ–¹ã®æ©Ÿèƒ½ã‚’æä¾›
}

// è§£æ±ºæ–¹æ³•2: ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã«ã™ã‚‹
@Service
public class UserService {
    @Autowired
    private ApplicationEventPublisher eventPublisher;
    
    public void updateUser(User user) {
        userRepository.save(user);
        eventPublisher.publishEvent(new UserUpdatedEvent(user));  // ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
    }
}

@Service
public class StudyBookService {
    @EventListener
    public void handleUserUpdated(UserUpdatedEvent event) {
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°æ™‚ã®å‡¦ç†
    }
}
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼
```yaml
# application.yml ã®è¨­å®šç¢ºèª
spring:
  datasource:
    url: jdbc:h2:mem:testdb  # H2 ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªDB
    driver-class-name: org.h2.Driver
    username: sa
    password: 
  
  jpa:
    hibernate:
      ddl-auto: create-drop  # é–‹ç™ºæ™‚ã®ã¿ä½¿ç”¨
    show-sql: true  # SQL ãƒ­ã‚°å‡ºåŠ›
    
  h2:
    console:
      enabled: true  # H2 ã‚³ãƒ³ã‚½ãƒ¼ãƒ«æœ‰åŠ¹åŒ–
```

### 4. CORS ã‚¨ãƒ©ãƒ¼
```java
// CorsConfig.java
@Configuration
public class CorsConfig {
    
    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        
        // è¨±å¯ã™ã‚‹ã‚ªãƒªã‚¸ãƒ³
        configuration.setAllowedOriginPatterns(Arrays.asList("*"));
        
        // è¨±å¯ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰
        configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS"));
        
        // è¨±å¯ã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼
        configuration.setAllowedHeaders(Arrays.asList("*"));
        
        // èªè¨¼æƒ…å ±ã®é€ä¿¡ã‚’è¨±å¯
        configuration.setAllowCredentials(true);
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        
        return source;
    }
}
```

### 5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```javascript
// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€
class ErrorHandlerService {
    
    /**
     * ã‚¨ãƒ©ãƒ¼ã‚’é©åˆ‡ã«å‡¦ç†ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
     */
    handle(error, context = {}) {
        console.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error, context);
        
        let userMessage;
        
        if (error instanceof NetworkError) {
            userMessage = 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
        } else if (error instanceof AuthenticationError) {
            userMessage = 'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚å†åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚';
            this.redirectToLogin();
        } else if (error instanceof ValidationError) {
            userMessage = `å…¥åŠ›ã‚¨ãƒ©ãƒ¼: ${error.message}`;
        } else {
            userMessage = 'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚';
        }
        
        this.displayErrorMessage(userMessage);
        
        // ã‚¨ãƒ©ãƒ¼å ±å‘Šï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«é€ä¿¡ï¼‰
        this.reportError(error, context);
    }
    
    displayErrorMessage(message) {
        // é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        this.notificationService.showError(message);
    }
    
    redirectToLogin() {
        window.location.href = '/login.html';
    }
    
    reportError(error, context) {
        // é–‹ç™ºç’°å¢ƒã§ã¯ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›
        if (process.env.NODE_ENV === 'development') {
            console.group('ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ');
            console.error('ã‚¨ãƒ©ãƒ¼:', error);
            console.log('ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ:', context);
            console.log('ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹:', error.stack);
            console.groupEnd();
        }
        
        // æœ¬ç•ªç’°å¢ƒã§ã¯å¤–éƒ¨ã‚¨ãƒ©ãƒ¼ç›£è¦–ã‚µãƒ¼ãƒ“ã‚¹ã«é€ä¿¡
        // ä¾‹: Sentry, Rollbar, Bugsnag ãªã©
    }
}
```

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã®æœ€é©åŒ–
```java
// å•é¡Œ: N+1 ã‚¯ã‚¨ãƒª
@Entity
public class StudyBookEntity {
    @ManyToOne(fetch = FetchType.LAZY)  // LAZY ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
    @JoinColumn(name = "user_id")
    private UserEntity user;
}

// è§£æ±ºæ–¹æ³•1: JOIN FETCH ã‚’ä½¿ç”¨
@Query("SELECT sb FROM StudyBookEntity sb JOIN FETCH sb.user WHERE sb.userId = :userId")
List<StudyBookEntity> findByUserIdWithUser(@Param("userId") String userId);

// è§£æ±ºæ–¹æ³•2: @EntityGraph ã‚’ä½¿ç”¨
@EntityGraph(attributePaths = {"user"})
@Query("SELECT sb FROM StudyBookEntity sb WHERE sb.userId = :userId")
List<StudyBookEntity> findByUserIdWithUserGraph(@Param("userId") String userId);
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨
```java
// Spring Cache ã‚’ä½¿ç”¨
@Service
public class StudyBookService {
    
    @Cacheable(value = "studybooks", key = "#userId")
    public List<StudyBook> getStudyBooksByUser(UserId userId) {
        return studyBookRepository.findByUserId(userId);
    }
    
    @CacheEvict(value = "studybooks", key = "#studyBook.userId")
    public StudyBook save(StudyBook studyBook) {
        return studyBookRepository.save(studyBook);
    }
}
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æœ€é©åŒ–
```javascript
// é…å»¶èª­ã¿è¾¼ã¿ï¼ˆLazy Loadingï¼‰
class LazyLoader {
    
    /**
     * ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã‚‹ç›´å‰ã«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã¿
     */
    async loadComponent(componentName) {
        const componentCache = this.componentCache || new Map();
        
        if (componentCache.has(componentName)) {
            return componentCache.get(componentName);
        }
        
        const component = await import(`./components/${componentName}.js`);
        componentCache.set(componentName, component);
        
        return component;
    }
}

// ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆå¤§é‡ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤ºï¼‰
class VirtualScrollList {
    constructor(container, itemHeight, renderItem) {
        this.container = container;
        this.itemHeight = itemHeight;
        this.renderItem = renderItem;
        this.visibleItems = [];
    }
    
    /**
     * è¡¨ç¤ºé ˜åŸŸã«å«ã¾ã‚Œã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ã¿ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
     */
    render(allItems) {
        const containerHeight = this.container.clientHeight;
        const scrollTop = this.container.scrollTop;
        
        const startIndex = Math.floor(scrollTop / this.itemHeight);
        const endIndex = Math.min(
            startIndex + Math.ceil(containerHeight / this.itemHeight) + 1,
            allItems.length
        );
        
        const visibleItems = allItems.slice(startIndex, endIndex);
        
        // DOM ã‚’æ›´æ–°
        this.container.innerHTML = '';
        visibleItems.forEach((item, index) => {
            const element = this.renderItem(item, startIndex + index);
            element.style.position = 'absolute';
            element.style.top = `${(startIndex + index) * this.itemHeight}px`;
            this.container.appendChild(element);
        });
        
        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é ˜åŸŸã®é«˜ã•ã‚’è¨­å®š
        this.container.style.height = `${allItems.length * this.itemHeight}px`;
    }
}
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### å…¥åŠ›æ¤œè¨¼
```java
// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®å…¥åŠ›æ¤œè¨¼
@RestController
public class StudyBookController {
    
    @PostMapping("/studybooks")
    public ResponseEntity<StudyBookResponse> create(
            @Valid @RequestBody CreateStudyBookRequest request) {  // @Valid ã§æ¤œè¨¼
        
        // è¿½åŠ ã®æ¤œè¨¼
        if (request.getQuestion().length() > 10000) {
            throw new ValidationException("å•é¡Œæ–‡ã¯10000æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
        }
        
        // XSS å¯¾ç­–: HTML ã‚¿ã‚°ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
        String sanitizedQuestion = HtmlUtils.htmlEscape(request.getQuestion());
        
        // SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ï¼ˆJPA ãŒè‡ªå‹•ã§å¯¾å¿œï¼‰
        StudyBook studyBook = createStudyBookUseCase.create(
            UserId.of(getCurrentUserId()),
            Language.of(request.getLanguage()),
            Question.of(sanitizedQuestion),
            Explanation.of(request.getExplanation())
        );
        
        return ResponseEntity.ok(mapper.toResponse(studyBook));
    }
}
```

### èªè¨¼ãƒ»èªå¯
```java
// JWT ãƒˆãƒ¼ã‚¯ãƒ³ã®æ¤œè¨¼
@Component
public class JwtAuthenticationFilter extends OncePerRequestFilter {
    
    @Override
    protected void doFilterInternal(
            HttpServletRequest request,
            HttpServletResponse response,
            FilterChain filterChain) throws ServletException, IOException {
        
        String token = extractToken(request);
        
        if (token != null && jwtTokenService.validateToken(token)) {
            // ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœ‰åŠ¹ãªå ´åˆã€èªè¨¼æƒ…å ±ã‚’è¨­å®š
            String userId = jwtTokenService.getUserIdFromToken(token);
            
            // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«èªè¨¼æƒ…å ±ã‚’è¨­å®š
            UsernamePasswordAuthenticationToken authentication = 
                new UsernamePasswordAuthenticationToken(userId, null, Collections.emptyList());
            SecurityContextHolder.getContext().setAuthentication(authentication);
        }
        
        filterChain.doFilter(request, response);
    }
    
    private String extractToken(HttpServletRequest request) {
        String bearerToken = request.getHeader("Authorization");
        if (bearerToken != null && bearerToken.startsWith("Bearer ")) {
            return bearerToken.substring(7);
        }
        return null;
    }
}
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
```javascript
// XSS å¯¾ç­–
class SecurityUtils {
    
    /**
     * HTML ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
     */
    static escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    /**
     * å®‰å…¨ãª innerHTML è¨­å®š
     */
    static setSafeInnerHTML(element, html) {
        // DOMPurify ãªã©ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ HTML ã‚’ã‚µãƒ‹ã‚¿ã‚¤ã‚º
        const cleanHtml = DOMPurify.sanitize(html);
        element.innerHTML = cleanHtml;
    }
}

// CSRF å¯¾ç­–
class ApiClient {
    
    async request(url, options = {}) {
        // CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
        const csrfToken = this.getCsrfToken();
        
        const headers = {
            'Content-Type': 'application/json',
            'X-CSRF-Token': csrfToken,
            ...options.headers
        };
        
        return fetch(url, {
            ...options,
            headers,
            credentials: 'same-origin'  // Cookie ã‚’é€ä¿¡
        });
    }
    
    getCsrfToken() {
        // ãƒ¡ã‚¿ã‚¿ã‚°ã‹ã‚‰ CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
        const metaTag = document.querySelector('meta[name="csrf-token"]');
        return metaTag ? metaTag.getAttribute('content') : '';
    }
}
```

## ğŸ“Š ç›£è¦–ã¨ãƒ­ã‚°

### ãƒ­ã‚°å‡ºåŠ›
```java
// æ§‹é€ åŒ–ãƒ­ã‚°ã®å‡ºåŠ›
@Service
public class AuthenticationApplicationService {
    private static final Logger logger = LoggerFactory.getLogger(AuthenticationApplicationService.class);
    
    public AuthenticationResult login(String loginId, String password) {
        // é–‹å§‹ãƒ­ã‚°
        logger.info("ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†é–‹å§‹: loginId={}", loginId);
        
        try {
            AuthenticationResult result = authenticateUseCase.authenticate(
                LoginId.of(loginId), 
                password
            );
            
            // æˆåŠŸãƒ­ã‚°
            logger.info("ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ: loginId={}, userId={}", 
                loginId, result.getUser().getId());
            
            return result;
            
        } catch (AuthenticationException e) {
            // ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
            logger.warn("ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—: loginId={}, reason={}", 
                loginId, e.getMessage());
            throw e;
            
        } catch (Exception e) {
            // äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼
            logger.error("ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ã§ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼: loginId={}", 
                loginId, e);
            throw new SystemException("ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ", e);
        }
    }
}
```

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
```java
// Micrometer ã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹
@Service
public class StudyBookApplicationService {
    private final Counter studyBookCreatedCounter;
    private final Timer studyBookCreationTimer;
    
    public StudyBookApplicationService(MeterRegistry meterRegistry) {
        this.studyBookCreatedCounter = Counter.builder("studybook.created")
            .description("ä½œæˆã•ã‚ŒãŸå­¦ç¿’å¸³ã®æ•°")
            .register(meterRegistry);
            
        this.studyBookCreationTimer = Timer.builder("studybook.creation.time")
            .description("å­¦ç¿’å¸³ä½œæˆã«ã‹ã‹ã£ãŸæ™‚é–“")
            .register(meterRegistry);
    }
    
    public StudyBook create(CreateStudyBookCommand command) {
        return studyBookCreationTimer.recordCallable(() -> {
            StudyBook studyBook = createStudyBookUseCase.create(command);
            studyBookCreatedCounter.increment();
            return studyBook;
        });
    }
}
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### Docker ã‚’ä½¿ç”¨ã—ãŸç’°å¢ƒæ§‹ç¯‰
```dockerfile
# Dockerfile.backend
FROM openjdk:17-jre-slim

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
RUN addgroup --system app && adduser --system --group app

# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®š
WORKDIR /app

# JAR ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼
COPY build/libs/rct-backend-*.jar app.jar

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å¤‰æ›´
USER app

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
ENTRYPOINT ["java", "-jar", "app.jar"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  backend:
    build:
      context: ./rct-backend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_DATASOURCE_URL=jdbc:postgresql://db:5432/rctdb
      - SPRING_DATASOURCE_USERNAME=rctuser
      - SPRING_DATASOURCE_PASSWORD=rctpass
    depends_on:
      - db
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
    ports:
      - "80:80"
    depends_on:
      - backend

  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=rctdb
      - POSTGRES_USER=rctuser
      - POSTGRES_PASSWORD=rctpass
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

volumes:
  postgres_data:
```

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up JDK 17
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'
    
    - name: Cache Gradle packages
      uses: actions/cache@v3
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
    
    - name: Run backend tests
      run: |
        cd rct-backend
        ./gradlew test
    
    - name: Run frontend tests
      run: |
        npm ci
        npm test
    
    - name: Generate test report
      uses: dorny/test-reporter@v1
      if: success() || failure()
      with:
        name: Test Results
        path: '**/build/test-results/test/TEST-*.xml'
        reporter: java-junit

  build:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Build backend
      run: |
        cd rct-backend
        ./gradlew bootJar
    
    - name: Build frontend
      run: |
        npm ci
        npm run build
    
    - name: Build Docker images
      run: |
        docker build -t rct-backend:${{ github.sha }} ./rct-backend
        docker build -t rct-frontend:${{ github.sha }} .
    
    - name: Deploy to staging
      if: github.ref == 'refs/heads/main'
      run: |
        # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
        ./deploy.sh staging ${{ github.sha }}
```

---

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å‚è€ƒã«ã€æ®µéšçš„ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç†è§£ã‚’æ·±ã‚ã¦ã„ã£ã¦ãã ã•ã„ã€‚
ã‚ã‹ã‚‰ãªã„ã“ã¨ãŒã‚ã‚Œã°ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦å‹•ä½œã‚’ç¢ºèªã—ã€
ãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã¦å‡¦ç†ã®æµã‚Œã‚’è¿½è·¡ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚